<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microbiome Lab | CBNU - Welcome</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 
        *** FIX FOR GITHUB PAGES ABSOLUTE PATHS ***
        Set the base URL for all relative URLs in the document. 
        You MUST replace "mblcbnu" below with your actual GitHub repository name.
        This fixes the issue where links like "research.html" become 
        "/mblcbnu/research.html" automatically.
    -->
          <base href="/mblcbnu/">   
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
        }
        .lab-color {
            color: #0d47a1; /* Deep Blue */
        }
        .lab-bg {
            background-color: #0d47a1;
        }
        .nav-link:hover {
            color: #1e88e5; /* Lighter Blue for hover */
        }
        .active-link {
            color: #1e88e5; /* Active link color */
            border-bottom: 2px solid #1e88e5;
            padding-bottom: 0.25rem;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #0d47a150;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
    </style>
</head>
<body class="text-gray-800 leading-relaxed">
    <!-- Header remains empty, ready to receive the navigation content from nav.html -->
	<header id="main-nav" class="shadow-md bg-white sticky top-0 z-10 border-b border-gray-200">
    </header>

    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10">

        <section id="home" class="bg-white rounded-xl shadow-2xl p-10 sm:p-16 mb-12 border-t-4 border-gray-200">
            <div class="flex items-start flex-col md:flex-row space-y-6 md:space-y-0 md:space-x-10">
                
                <div class="flex-shrink-0">
                    <!-- Image path corrected to be relative -->
                    <img src="./MBLLOGO4.png" alt="Microbiome Lab Logo" class="h-28 w-auto rounded-lg shadow-xl border-4 border-gray-300">
                </div>

                <div class="text-gray-800">
                    <h1 class="text-5xl sm:text-6xl font-extrabold lab-color mb-4 leading-tight">
                        Microbiome Lab
                    </h1>
                    <p class="text-2xl font-light mb-4">
                        Department of Microbiology, Chungbuk National University
                    </p>
                    <p class="text-lg font-medium">
                        Cheongju, South Korea
                    </p>
                </div>
            </div>
        </section>

        <section id="news" class="bg-white rounded-xl shadow-lg p-10 mb-12">
            <h2 class="text-3xl font-bold lab-color mb-4 border-b pb-2">Latest News & Updates</h2>
            <div id="news-container" class="h-96 overflow-y-auto pr-4 custom-scrollbar"> 
                <div id="news-list" class="space-y-6">
                    <p class="text-gray-500 italic">Loading latest news...</p>
                </div>
            </div>
        </section>

        <section id="contact-info" class="grid grid-cols-1 md:grid-cols-5 gap-8 mb-12">
            <div class="md:col-span-2 bg-white rounded-xl shadow-lg p-8 border-l-4 border-blue-400">
                <h3 class="text-2xl font-semibold lab-color mb-3">Principal Investigator</h3>
                <p class="text-gray-700">Dr. Tatsuya Unno</p>
                <p class="text-gray-500 text-sm mt-1">
                    <a href="mailto:tatsu@cbnu.ac.kr" class="text-blue-500 hover:underline">tatsu@cbnu.ac.kr</a><br>
                    Office: 043-261-2304
                </p>
            </div>
            <div class="md:col-span-3 bg-white rounded-xl shadow-lg p-8 border-l-4 border-blue-400">
                <h3 class="text-2xl font-semibold lab-color mb-3">Physical Address</h3>
                <p class="text-gray-700">
                    Department of Microbiology<br>
                    Department of Biological Sciences and Biotechnology (Grad. school)<br>
                    Chungbuk National University<br>
                    Chungdae-ro 1, Seowon-Gu, Cheongju,<br>
                    Chungbuk 28644, Republic of Korea
                </p>
            </div>
        </section>

    </main>

    <footer>
        <div class="bg-gray-800 text-white py-6 mt-12">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-sm">
                <p>&copy; 2025 Microbiome Lab. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <script>
        // Function to load the external navigation HTML
	    async function loadNavbar() {
            try {
                // Fetch the navigation HTML from the separate file
                const response = await fetch('./nav.html');
                if (!response.ok) throw new Error('Navigation file (nav.html) not found.');
                
                const data = await response.text();
                const navContainer = document.getElementById('main-nav');
                navContainer.innerHTML = data;
                
                // Get the current page file name (e.g., 'index.html', 'research.html')
                const pathParts = window.location.pathname.split('/').filter(p => p.length > 0);
                const currentPage = pathParts.pop() || 'index.html'; // Gets the last segment (the file name)

                // Set active link based on current page path
                const links = navContainer.querySelectorAll('.nav-link');
                
                links.forEach(link => {
                    // Extract the file name from the link's href (e.g., '/index.html' -> 'index.html')
                    const linkPath = link.getAttribute('href').split('/').pop() || 'index.html';
                    
                    if (linkPath === currentPage) {
                        link.classList.add('active-link');
                        link.classList.remove('text-gray-600', 'hover:lab-color'); // Ensure gray is removed
                    }
                });

            } catch (error) {
                console.error("Error loading navigation:", error);
            }
        }


        // Function to load news data (assuming news_data.json exists at the project root)
        async function loadNews() {
            const newsListDiv = document.getElementById('news-list');
            
            try {
                // Note: using relative path for news_data.json
                const response = await fetch('./news_data.json'); 
                
                if (!response.ok) {
                    if (response.status === 404) {
                        throw new Error("File not found (404). Make sure 'news_data.json' exists in the same directory.");
                    }
                    throw new Error(`Failed to fetch news data: ${response.statusText}`);
                }
                
                const newsData = await response.json();
                
                newsListDiv.innerHTML = newsData.map(item => `
                    <div class="border-b pb-4">
                        <span class="text-sm font-semibold ${item.color} block">${item.date}</span>
                        <p class="text-lg font-medium text-gray-800 mt-1">
                            <span class="lab-color font-bold mr-2">${item.title_tag}</span>
                            ${item.content}
                        </p>
                        ${item.link && item.link_text ? 
                            `<a href="${item.link}" target="_blank" class="text-blue-500 hover:underline text-sm block mt-1">${item.link_text}</a>` 
                            : ''
                        }
                    </div>
                `).join('');


            } catch (error) {
                console.error("Error loading news:", error);
                newsListDiv.innerHTML = `<p class="text-red-600">Error: Could not load news updates. Please check the 'news_data.json' file.</p>`;
            }
        }

        window.addEventListener('DOMContentLoaded', () => {
            loadNavbar();
            loadNews();
        });

    </script>

</body>
</html>
